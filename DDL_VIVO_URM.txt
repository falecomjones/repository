customer:

customerlegalname   	varchar(50)         	                    
maincontactkey      	int                 	                    
customerkey         	int                 	                    
customertypekey     	char(1)

insert into customer values ('fulano da silva', 3, 3, 'C');


CONTACT.IDENTIFICATIONDOCUMENT1NUMBER AS CNPJ_CPF, --CUSTOMER     
    CONTACT.IDENTIFICATIONDOCUMENT2NUMBER AS DOC_ASSINANTE, --CUSTOMER
    CONTACT.IDENTIFICATION2TYPECODE AS TIPO_DOC_ASSINANTE, --CUSTOMER 
	CONTACT.PHONENUMBER AS CONTATO_TELEFONE, --CUSTOMER
	CONTACT.EMAILID AS CONTATO_EMAIL, --CUSTOMER
	CONTACT.CONTACTKEY
	
create table contact (IDENTIFICATIONDOCUMENT1NUMBER bigint, IDENTIFICATIONDOCUMENT2NUMBER varchar,IDENTIFICATION2TYPECODE varchar, PHONENUMBER varchar, EMAILID varchar, CONTACTKEY integer);
insert into contact values (3, '3', '3', '88339900', 'jdkalkj@hfakj', 3);

SUB.LINEOFBUSINESSKEY AS TIPO_SERVICO, --MOBILE_LINE, FIXED_LINE
   SUB.SUBSCRIBERMSISDNALIAS AS NUM_SERVICO, --MOBILE_LINE, FIXED_LINE
-- SUB.OFFERTECHNOLOGY AS END_TIPO,   -- TRANSFORMAR, MAS QUAL A REGRA?  --MOBILE_LINE
   SUB.SUBSCRIBERKEY,
   SUB.MAINADDRESSKEY,
   SUB.CUSTOMERKEY
   SUB.PRIMARYRESOURCEVALUE

  
create table subscriber ( LINEOFBUSINESSKEY varchar(20), SUBSCRIBERMSISDNALIAS varchar(20), OFFERTECHNOLOGY varchar(20), SUBSCRIBERKEY integer, MAINADDRESSKEY integer, CUSTOMERKEY integer, PRIMARYRESOURCEVALUE varchar(20));
insert into subscriber values ('3', 'C', 'C', 3, 3, 3, 'C');


STATUS.SUBSCRIBERSTATUSCHANGEDATE
STATUS.SUBSCRIBERKEY
STATUS.CURRENTSUBSCRIBERSTATUSKEY

create table subscriberstatushist (SUBSCRIBERSTATUSCHANGEDATE date, SUBSCRIBERKEY integer, CURRENTSUBSCRIBERSTATUSKEY integer);

insert into subscriberstatushist values ('1900-08-20 00:00:00.0', 1, 1);
insert into subscriberstatushist values ('1900-08-20 00:00:00.0', 3, 3);
-----
T2

ADDRHIST.SUBSCRIBERMAINADDRESSKEY,
	ADDRHIST.STARTDATE, 
	ADDRHIST.ENDDATE, 
	--IF(STARTDATE <= DT_FIM AND ENDDATE >= DT_INICIO, 'SIM', 'NAO') as MANTER
	SITUACAO
	DT_FIM
	DT_INICIO
	
	LEFT JOIN SUBSCRIBERADDRESSHIST ADDRHIST 
	ON ADDRHIST.SUBSCRIBERKEY = T1.SUBSCRIBERKEY
	
create table subscriberaddresshist (STARTDATE date, ENDDATE date, SITUACAO varchar(1), DT_FIM date, DT_INICIO date);

	